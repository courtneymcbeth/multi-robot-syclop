# MR-SyCLoP Configuration with DB-RRT Guided Planner
#
# This configuration demonstrates how to use DB-RRT as the guided planner
# for low-level path planning in the MR-SyCLoP framework.

# Decomposition configuration (required)
# decomposition_region_length: 1  # Grid cell size for region decomposition
# Decomposition region length
decomposition_region_length: 5

# Path segmentation configuration
segment_timesteps: 30      # Number of timesteps per segment

# High-level MAPF solver
mapf:
  method: "cbs"           # Options: "decoupled", "astar", "cbs"
  region_capacity: 2      # Maximum robots per region (vertex/edge)

# mapf_method: "cbs"  # Options: "cbs", "decoupled"

# Low-level guided planner
guided_planner_method: "db_rrt"  # Options: "syclop_rrt", "db_rrt"

# Guided planner configuration
guided_planner:
  # Time budget per robot (seconds)
  time_per_robot: 10.0

  # Debug output
  debug: true

  # SyclopRRT-specific parameters (only used if guided_planner_method: "syclop_rrt")
  num_free_volume_samples: 100000
  num_region_expansions: 100
  num_tree_expansions: 1
  prob_abandon_lead_early: 0.25
  prob_shortest_path: 0.95
  use_regional_nn: true

  # DB-RRT specific parameters (only used if guided_planner_method: "db_rrt")
  db_rrt:
    # Path to motion primitives file
    motions_file: "db-CBS/dynoplan/dynomotions/unicycle1_v0__ispso__2023_04_03__14_56_57.bin.im.bin.im.bin.small5000.msgpack"

    # Path to dynobench models directory (must end with /)
    models_base_path: "db-CBS/dynoplan/dynobench/models/"

    # Planning parameters
    timelimit: 10.0           # Time limit in seconds (overridden by time_per_robot)
    max_expands: 10000        # Maximum tree expansions
    goal_region: 0.3          # Goal region radius
    delta: 0.3                # Step size for extension
    goal_bias: 0.1            # Probability of sampling goal
    max_motions: 1000         # Maximum motion primitives to load
    seed: -1                  # Random seed (-1 for random)

    # Optimization
    do_optimization: true    # Enable trajectory optimization
    solver_id: 0              # Trajectory optimizer solver ID

    # Advanced parameters
    use_nigh_nn: true         # Use nigh nearest neighbor data structure
    debug: false              # DB-RRT debug output

    # Region guidance
    use_region_guidance: true # Use region path for guidance
    region_bias: 0.3          # Bias towards regions in path

# Collision resolution strategy
collision_resolution_method: "coupled_rrt"  # Options: "coupled_rrt", "drrt", "srrt", "none"

# Coupled RRT configuration (for collision resolution)
coupled_rrt:
  time_per_group: 30.0
  max_planning_time: 120.0
  use_connect: true

# Planning parameters
max_iterations: 10            # Maximum collision resolution iterations
segment_duration: 0.5         # Duration of trajectory segments for collision checking (seconds)

# Environment decomposition
decomposition:
  type: "grid"                # "grid" or "triangulation"
  resolution: [10, 10, 1]     # Grid cells in x, y, z (z=1 for 2D)

# Debug options
debug:
  print_stats: true
  save_paths: true
  visualization: false

# Example robot-specific motion primitives
# If you want to specify different primitives per robot type, you can do:
# robot_motion_primitives:
#   unicycle1_v0: "db-CBS/dynoplan/dynomotions/unicycle1_v0__ispso__2023_04_03__14_56_57.bin.im.bin.im.bin.small5000.msgpack"
#   quad2d_v0: "db-CBS/dynoplan/dynomotions/quad2d_v0_all_im.bin.sp.bin.ca.bin.small5000.msgpack"
#   quad3d_v0: "db-CBS/dynoplan/dynomotions/quad3d_v0_all3.bin.im.bin.sp1.bin.ca.bin.small5000.msgpack"
